#!/usr/sbin/nft -f

flush ruleset

table inet filter {
    chain input {
        type filter hook input priority 0; policy drop

        # Allow established/related connections
        ct state established,related accept

        # Maintenance mode rules
        tcp dport 22 accept comment "SSH"
        tcp dport 8551 accept comment "Consensus Client Engine API"
        tcp dport 30303 accept comment "Execution Client P2P"
        tcp dport { 8545, 8546 } accept comment "Execution Client RPC"
        tcp dport 27017 accept comment "Searcher Input Channel"
    }

    chain output {
        type filter hook output priority 0; policy accept
    }

    chain forward {
        type filter hook forward priority 0; policy drop
    }
}

#!/usr/sbin/nft -f

flush ruleset

table inet filter {
    chain input {
        type filter hook input priority 0; policy drop
        
        # Allow existing SSH connections to complete the transition
        tcp dport 22 ct state established accept
        
        # Drop all new connections
        ct state new drop
        
        # Drop everything else
        drop
    }

    chain forward {
        type filter hook forward priority 0; policy drop
    }

    chain output {
        type filter hook output priority 0; policy drop
        
        # Allow responses for existing SSH connections
        tcp sport 22 ct state established accept
        
        # Drop everything else
        drop
    }
}
